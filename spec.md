# マーダーミステリーゲーム 仕様書

## 1. プロジェクト概要

### 1.1 ゲーム名
**「クリムゾン・マンション殺人事件」**

### 1.2 ゲーム概要
プレイヤーが容疑者となり、議論と推理を通じて真犯人を見つけ出すオンライン対応のマーダーミステリーゲーム。各プレイヤーは個別のキャラクターを演じ、秘密を隠しながら事件の真相に迫る。

### 1.3 ターゲット
- 推理ゲーム好きの10代後半〜40代
- オンライン協力ゲームを楽しむユーザー
- ボードゲーム愛好者

## 2. ゲーム仕様

### 2.1 基本仕様
- **プレイ人数**: 4-8人
- **プレイ時間**: 90-120分
- **対応プラットフォーム**: PC（Web）、スマートフォン
- **通信**: リアルタイム通信（WebSocket）
- **音声**: オプション（Discord連携）

### 2.2 ゲームフロー

#### フェーズ1: 準備（10分）
1. **ルーム作成・参加**
   - ホストがルーム作成
   - 招待コードでプレイヤー参加
   - キャラクター選択（先着順 or ランダム割当）

2. **キャラクター情報配布**
   - 各プレイヤーに個別のハンドアウト配布
   - 基本情報、秘密、個人目標の確認時間

#### フェーズ2: 情報収集（20分）
1. **事件発生の報告**
   - GMまたはシステムによる事件概要の説明
   - 被害者、現場、発見時刻等の基本情報提示

2. **初期情報開示**
   - 各プレイヤーが知っている基本的な情報を共有
   - アリバイの確認

#### フェーズ3: 議論フェーズ1（25分）
1. **全体議論**
   - 証拠品の提示と検討
   - 疑問点の質疑応答
   - 各キャラクターの行動履歴確認

2. **投票準備**
   - 現時点での疑惑度合いの表明

#### フェーズ4: 密談フェーズ（15分）
1. **1対1の秘密会話**
   - 任意の2人で個別ルームでの会話
   - 秘密情報の交換や同盟の形成
   - 最大2回まで相手を変更可能

#### フェーズ5: 議論フェーズ2（25分）
1. **最終議論**
   - 密談で得た情報を踏まえた推理
   - 最終的な証拠の整理
   - 各プレイヤーの最終弁論

#### フェーズ6: 投票・結果（15分）
1. **犯人投票**
   - 各プレイヤーが犯人だと思う人に投票
   - 投票理由の簡潔な説明

2. **結果発表**
   - 真犯人の発表
   - 各キャラクターの真実と動機の公開
   - 個人目標の達成度判定

### 2.3 勝利条件

#### 市民チーム
- 真犯人を正しく特定する

#### 犯人
- 最終投票で犯人に選ばれない
- 個人目標を達成する

#### 個人目標
各キャラクターには個別の勝利条件が設定される
- 「特定の秘密を隠し通す」
- 「特定の証拠を入手する」
- 「特定の人物と協力関係を築く」等

## 3. システム機能

### 3.1 ユーザー管理
- **アカウント登録・ログイン**
  - ゲスト参加機能
  - ニックネーム設定
  - プレイ履歴の記録

### 3.2 ルーム管理
- **ルーム作成**
  - パスワード設定
  - シナリオ選択
  - 参加人数設定
  - 友達招待機能

- **ルーム参加**
  - 招待コード入力
  - パブリックルーム検索
  - 観戦者モード

### 3.3 ゲーム進行システム
- **タイマー機能**
  - フェーズごとの制限時間
  - 残り時間の表示
  - 自動フェーズ移行

- **チャット機能**
  - 全体チャット
  - 密談用個別チャット
  - 既読機能
  - ログ保存

- **投票システム**
  - 匿名投票
  - 投票結果の集計
  - 同数票の処理

### 3.4 情報管理
- **ハンドアウト表示**
  - 個人専用情報の表示
  - 証拠品の管理
  - メモ機能

- **推理ノート**
  - プレイヤー情報整理
  - 時系列メモ
  - 疑惑度メーター

## 4. シナリオ「クリムゾン・マンション殺人事件」

### 4.1 設定
**時代**: 現代  
**場所**: 山奥の豪華別荘「クリムゾン・マンション」  
**状況**: 嵐により外部と遮断された別荘で殺人事件が発生

### 4.2 登場キャラクター（8人）

1. **富豪の息子** - 大学生、相続問題を抱える
2. **秘書** - 被害者の右腕、多くの秘密を知る
3. **料理人** - ベテラン、家族の医療費に悩む
4. **メイド** - 新人、過去に問題を起こしている
5. **医師** - 家族の友人、実は多額の借金がある
6. **弁護士** - 遺言書の作成に関わる、職業的秘密多数
7. **作家** - 取材のため滞在、実は被害者の過去を調査中
8. **庭師** - 長年仕える、被害者に恨みを持つ理由がある

### 4.3 事件概要
- **被害者**: 富豪の父親（別荘の主人）
- **死因**: 毒殺
- **発見場所**: 書斎
- **発見時刻**: 夜10時頃
- **凶器**: 毒入りのブランデー

### 4.4 証拠品・手がかり
1. 毒の入ったブランデーグラス
2. 破かれた遺言書の断片
3. 被害者の日記
4. 不審な電話の記録
5. 薬品の空き瓶
6. 別荘の見取り図（秘密の通路あり）

## 5. 技術仕様

### 5.1 フロントエンド
- **フレームワーク**: React.js / Vue.js
- **UI ライブラリ**: Material-UI / Ant Design
- **リアルタイム通信**: Socket.io-client
- **状態管理**: Redux / Vuex

### 5.2 バックエンド
- **サーバー**: Node.js / Express
- **データベース**: MongoDB / PostgreSQL
- **リアルタイム通信**: Socket.io
- **認証**: JWT

### 5.3 インフラ
- **ホスティング**: AWS / Heroku
- **CDN**: CloudFlare
- **監視**: New Relic / Datadog

## 6. UI/UX 設計

### 6.1 メイン画面レイアウト
```
┌─────────────────────────────────────────┐
│ ヘッダー（タイマー、フェーズ表示）         │
├─────────────┬───────────────────────────┤
│ プレイヤー一覧│ メインエリア                │
│               │ - チャット                  │
│ ・アバター     │ - 情報表示                  │
│ ・ニックネーム │ - 投票UI                    │
│ ・状態表示     │                            │
├─────────────┼───────────────────────────┤
│ 個人情報エリア │ システムメッセージ          │
│ - ハンドアウト │                            │
│ - 推理ノート   │                            │
└─────────────┴───────────────────────────┘
```

### 6.2 カラーパレット
- **メインカラー**: ダークレッド (#8B0000)
- **サブカラー**: ゴールド (#FFD700)
- **背景色**: ダークグレー (#2C2C2C)
- **テキスト**: ホワイト (#FFFFFF)

## 7. 開発スケジュール

### Phase 1: 基盤開発（4週間）
- Week 1-2: プロジェクト設定、基本UI作成
- Week 3-4: ユーザー管理、ルーム管理機能

### Phase 2: コア機能開発（6週間）
- Week 5-7: ゲーム進行システム、チャット機能
- Week 8-10: 投票システム、情報管理機能

### Phase 3: シナリオ実装（4週間）
- Week 11-12: シナリオデータ実装
- Week 13-14: ゲームバランス調整

### Phase 4: テスト・リリース（3週間）
- Week 15-16: 総合テスト、バグ修正
- Week 17: デプロイ、リリース

## 8. 想定課題と対策

### 8.1 技術的課題
- **同期問題**: WebSocketの接続管理を厳密に行い、切断時の自動再接続を実装
- **スケーラビリティ**: 負荷分散とデータベース最適化

### 8.2 ゲームデザイン課題
- **プレイヤー離脱**: 途中離脱時のAI代替システム
- **時間管理**: フェーズごとの適切な時間設定とフレキシブルな調整機能

### 8.3 運用課題
- **不適切な発言**: 通報システムとモデレーション機能
- **ネタバレ防止**: プレイ済みシナリオの記録と警告システム

## 9. 将来的な拡張計画

### 9.1 機能拡張
- カスタムシナリオ作成ツール
- 音声チャット統合
- VR対応
- AI GMモード

### 9.2 コンテンツ拡張
- 追加シナリオパック
- 季節イベント
- 有名IPとのコラボレーション

### 9.3 プラットフォーム拡張
- モバイルアプリ版
- Steam配信
- コンソール版検討

## 10. 収益モデル

### 10.1 基本プラン
- 無料プレイ（制限あり）
- プレミアム月額会員制
- 追加シナリオ購入

### 10.2 追加収益
- カスタマイズアイテム
- 広告収入
- イベント参加費
